<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="V3_Member">
	<select id="selectMemberList" resultType="V3_Member">
		SELECT email, name, phone, TO_CHAR(date1, 'YYYY-MM-DD') date1 FROM V3_MEMBER
	</select>
	
	<insert id="insertMember" statementType="CALLABLE" parameterType="V3_Member" useGeneratedKeys="false">
		call V3_MEMBER_ADDR_INSERT(
			#{email, mode=IN, jdbcType=VARCHAR},
			#{pw, mode=IN, jdbcType=VARCHAR},
			#{name, mode=IN, jdbcType=VARCHAR},
			#{phone, mode=IN, jdbcType=VARCHAR},
			#{post_code, mode=IN, jdbcType=VARCHAR},
			#{addr1, mode=IN, jdbcType=VARCHAR},
			#{addr2, mode=IN, jdbcType=VARCHAR},
			#{ns_name_str, mode=IN, jdbcType=VARCHAR}
		)
	</insert>

	<select id="selectMemberOne" parameterType="String" resultType="V3_Member">
		SELECT m.email, m.name, m.phone, ma.post_code, ma.addr1, ma.addr2
		FROM 
			V3_MEMBER m
		INNER JOIN 
			V3_MEMBER_ADDR ma
		ON 
			m.email = ma.email
		WHERE 
			m.email = #{email}
	</select>
	
	<update id="updateMember" statementType="CALLABLE" parameterType="V3_Member" useGeneratedKeys="false">
		call V3_MEMBER_ADDR_UPDATE(
			#{email, mode=IN, jdbcType=VARCHAR},
			#{name, mode=IN, jdbcType=VARCHAR},
			#{phone, mode=IN, jdbcType=VARCHAR},
			#{post_code, mode=IN, jdbcType=VARCHAR},
			#{addr1, mode=IN, jdbcType=VARCHAR},
			#{addr2, mode=IN, jdbcType=VARCHAR}
		)
	</update>
	
	<delete id="deleteMember" statementType="CALLABLE" parameterType="V3_Member">
		call V3_MEMBER_DEL1(
			#{email, mode=IN, jdbcType=VARCHAR},
			#{pw, mode=IN, jdbcType=VARCHAR}
		)
	</delete>
	
	<select id="selectMemberLogin" parameterType="V3_Member" resultType="V3_Member">
		SELECT * FROM V3_MEMBER WHERE email=#{email} AND pw=#{pw}
	</select>
	
	<update id="updateMemberPw" parameterType="V3_Member">
		UPDATE V3_MEMBER SET pw=#{pw1} WHERE email=#{email} AND pw=#{pw}
	</update>
	
</mapper>